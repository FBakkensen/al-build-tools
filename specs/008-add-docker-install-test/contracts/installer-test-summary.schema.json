{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$comment": "G14: Minimal schema intentionally excludes optional enrichment fields; see spec 'Schema Alignment Note (G14)'.",
  "title": "Installer Test Summary",
  "type": "object",
  "required": [
    "image",
    "startTime",
    "endTime",
    "durationSeconds",
    "releaseTag",
    "assetName",
    "exitCode",
    "success",
    "psVersion"
  ],
  "properties": {
    "image": { "type": "string", "description": "Container image reference used." },
    "containerId": { "type": "string", "description": "Docker container ID." },
    "startTime": { "type": "string", "format": "date-time" },
    "endTime": { "type": "string", "format": "date-time" },
    "durationSeconds": { "type": "integer", "minimum": 0 },
    "releaseTag": { "type": "string" },
    "assetName": { "type": "string" },
  "exitCode": { "type": "integer", "enum": [0,1,2,6], "description": "Process exit code (restricted set)." },
    "success": { "type": "boolean" },
    "psVersion": { "type": "string", "pattern": "^7\\.(?:[2-9]|[1-9][0-9])\\.\\d+$" },
    "runId": { "type": "string", "description": "Optional short unique identifier for this harness execution." },
  "imagePullSeconds": { "type": "integer", "minimum": 0, "description": "Wall-clock seconds (floor) spent pulling the container image." },
  "containerCreateSeconds": { "type": "integer", "minimum": 0, "description": "Wall-clock seconds (floor) spent creating & starting container after pull." },
    "errorSummary": { "type": "string" },
    "installedPrerequisites": {
      "type": "array",
      "items": { "type": "string" },
      "description": "List of prerequisites successfully installed during execution (e.g., choco, git, dotnet, InvokeBuild)."
    },
    "failedPrerequisites": {
      "type": "array",
      "items": { "type": "string" },
      "description": "List of prerequisites that started installation but failed to complete."
    },
    "lastCompletedStep": {
      "type": "string",
      "description": "Name of the last successfully completed installation step before failure (parsed from step markers)."
    },
    "guardCondition": {
      "type": "string",
      "description": "Guard condition that caused installer rejection (e.g., GitRepoRequired, PowerShellVersionUnsupported)."
    },
    "logs": {
      "type": "object",
      "required": ["transcript"],
      "properties": {
        "transcript": { "type": "string" },
        "additional": { "type": "array", "items": { "type": "string" } }
      }
    }
  },
  "additionalProperties": false
}
